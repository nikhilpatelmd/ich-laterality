---
title: Patients with Left Hemispheric Intracerebral Hemorrhage are Less Likely to Receive Neurosurgical Intervention
subtitle: A Bayesian Analysis of ATACH-2 and ERICH
authors:
  - name: Nikhil Patel
    orcid: 0000-0002-3193-8590
    affiliation: Department of Neurology, Wake Forest University School of Medicine
    roles: data analysis, writing
    corresponding: true
  - name: Matt Jaffa
    affiliation: Department of Neurology, University of Connecticut School of Medicine
  - name: Rahul Karamchandani
    affiliation: Department of Neurology, Wake Forest University School of Medicine
  - name: Andrew Asimos
    affiliation: Department of Emergency Medicine, Wake Forest University School of Medicine
  - name: Jonathan Parish
    affiliation: Carolina Neurosurgery & Spine Associates
  - name: Nicholas Allen Morris
    affiliation: Department of Neurology, University of Maryland School of Medicine
date: last-modified
abstract: |
  Hemispheric laterality blah blah blah
bibliography: references.bib
csl: american-heart-association.csl
mainfont: Figtree
---

```{r}
library(targets)
library(tidyverse)
library(withr)
library(here)
library(formattable)
library(gt)
library(gtsummary)
library(modelsummary)
library(marginaleffects)
library(tidybayes)
library(bayesplot)
library(ggdist)
library(patchwork)
library(tinytable)
library(flextable)

# plot stuff
theme_ich <- function(base_family = "Figtree",
                      base_size = 14) {
  theme_minimal(base_size = base_size) +
    theme(
      text = element_text(lineheight = 2),
      plot.title = element_text(size = rel(1.3), margin = margin(12, 0, 8, 0)),
      plot.subtitle = element_text(size = rel(1.1), margin = margin(4, 0, 0, 0)),
      axis.text.y = element_text(size = rel(0.8)),
      axis.title.y = element_text(size = 12, margin = margin(0, 4, 0, 0)),
      axis.text.x = element_text(size = rel(2)),
      axis.title.x = element_blank(),
      legend.position = "bottom",
      legend.justification = 1,
      panel.grid = element_line(colour = "#F3F4F5"),
      plot.caption = element_text(size = rel(0.8), margin = margin(8, 0, 0, 0)),
      plot.margin = margin(0.25, 0.25, 0.25, 0.25, "cm")
    )
}

# load data and models
with_dir(here(), tar_load(ich_aggressive))

sample_size <- count(ich_aggressive)

left_hemisphere_count <- ich_aggressive |>
  filter(ich_laterality == "Left") |>
  count()

models <- list(
  "Neurosurgical Intervention" = with_dir(here(), tar_read(m_posterior_neurosurgery_canonical)),
  "External Ventricular Drain" = with_dir(here(), tar_read(m_posterior_evd_canonical)),
  "Tracheostomy" = with_dir(here(), tar_read(m_posterior_trach_canonical)),
  "Days of Mechanical Ventilation" = with_dir(here(), tar_read(m_posterior_vent_canonical)),
  "Withdrawal of Life-Sustaining Therapy" = with_dir(here(), tar_read(m_posterior_comfort_canonical)),
  "Early Withdrawal of Life-Sustaining Therapy" = with_dir(here(), tar_read(m_posterior_early_comfort_canonical)),
  "DNR Order" = with_dir(here(), tar_read(m_posterior_dnr_canonical))
)

```

## Introduction
The clinical presentation of patients with stroke can vary based on the hemisphere affected, in particular with language, spatial orientation, and emotional processing. Previous research involving patients with ischemic stroke provide evidence that those with right hemispheric injury present later to the hospital and may not be treated as frequently with thrombolytic therapy.[@legge_neglecting_2006; @di_legge_impact_2005] On the other hand, there is a hesitation among some practitioners to offer decompressive craniectomy in patients with dominant-hemispheric infarcts. [@lin_decompressive_2021-1]

It is unclear how previous research in the ischemic stroke population translates to patients experiencing intracerebral hemorrhage. Not much has been investigated.

We aimed to evaluate the effect of hemispheric lateralization on the probability of receiving aggressive care in patients with ICH.

## Methods

### Study Design and Participants

We conducted a cohort study using data from 2 prospective studies: the Antihypertensive Treatment of Acute Cerebral Hemorrhage II (ATACH-2) trial [@qureshi_intensive_2016] and the Ethnic/Racial Variations of Intracerebral Hemorrhage (ERICH)[@woo_ethnicracial_2013] study. ATACH-2 was a large, multicenter, international, open-label, blinded-endpoint randomized controlled trial enrolling 1000 patients with ICH while ERICH was a large, multicenter, prospective observational study enrolling patients in the United States admitted with ICH. Study protocols and results of both studies have been previously published and are available elsewhere.

We included all patients enrolled in these two studies with supratentorial location of ICH. We excluded patients with cerebellar or brainstem ICH as well as any patient with primary intraventricular hemorrhage (IVH).

The study was approved by the institutional review board of the Wake Forest School of Medicine.

#### Data Availability Statement

The ATACH-2 (PI: Adnan I. Qureshi, MD, NCT01176565) and ERICH (PI: Daniel Woo, MD, MS, NCT01202864) data and analyses presented in this manuscript are based on the research files downloaded from the Archived Clinical Research web site of the National Institute of Neurologic Disease and Stroke (NINDS). The datasets can be obtained after approval of a written proposal as outlined on the NINDS website. 

As outlined in the NINDS Data Request Agreement, the analysis code is publicly available at [https://github.com/nikhilpatelmd/ich-laterality](https://github.com/nikhilpatelmd/ich-laterality).

### Exposures and Outcomes

Our exposure was hemispheric laterality (left versus right). Our primary outcome was neurosurgical intervention, defined as receiving a hematoma evacuation, decompressive craniectomy, or other craniotomy. 

To explore differences in other aspects of aggressive care, we defined several secondary outcomes: receipt of external ventricular drain (EVD), tracheostomy, percutaneous endoscopic gastrostomy (PEG) tube, do-not-resuscitate (DNR) order at any point in the hospitalization, withdrawal of life-sustaining therapy (WLST) at any point in the hospitalization, and early WLST (< 72 from symptom onset).

### Statistical Analysis

#### Overall Analysis Plan

## Results

### Baseline Characteristics

A total of `r sample_size` patients were included in the analysis, of which `r left_hemisphere_count` (`r percent(left_hemisphere_count/sample_size, digits = 1)`) had left hemispheric ICH. They had higher NIHSS scores, higher GCS scores, and lower rates of hypertension as compared to those with right hemispheric ICH (@tbl-1).

```{r table_1}
#| label: tbl-1
#| tbl-cap: "Baseline Characteristics"

with_dir(here(), tar_read(table_1_aggressive)) |>
  as_flex_table() |>
  font(part = "all", fontname = "Figtree") |>
  fontsize(size = 11, part = "header") |>
  fontsize(size = 10) |>
  theme_zebra() |>
  line_spacing(space = 1.25, part = "all") |>
  padding(padding = 4, part = "all")

```

### Left hemispheric ICH and neurosurgical intervention



```{r neurosurgery}
#| label: tbl-2
#| tbl-cap: "Association between hemispheric lateralization and care"#|

summary <- modelsummary(models,
  exponentiate = TRUE,
  fmt = 2,
  estimate = "{estimate}",
  statistic = "{conf.low} - {conf.high}",
  coef_omit = "^(?!b_ich_lat)",
  coef_rename = c("b_ich_lateralityRight" = "Right Hemisphere ICH"),
  gof_map = c("none")
)

# gather odds ratios from modelsummary object
odds_ratios <- summary |> map(pluck(1))
odds_ratios[1] <- NULL

# gather credible intervals from modelsummary object
credible_ints <- summary |> map(pluck(2))
credible_ints[1] <- NULL


# gather posterior probabilities of various magnitudes of difference
neurosurgery <- models$"Neurosurgical Intervention" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

evd <- models$"External Ventricular Drain" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

trach <- models$"Tracheostomy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

vent <- models$"Days of Mechanical Ventilation" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

dnr <- models$"DNR Order" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

wlst <- models$"Withdrawal of Life-Sustaining Therapy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

early_wlst <- models$"Early Withdrawal of Life-Sustaining Therapy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

# combine probability of OR > 1 (prob of difference)
prob_difference <- list(
  "Neurosurgical Intervention" = pluck(neurosurgery, 1),
  "External Ventricular Drain" = pluck(evd, 1),
  "Tracheostomy" = pluck(trach, 1),
  "Days of Mechanical Ventilation" = pluck(vent, 1),
  "Withdrawal of Life-Sustaining Therapy" = pluck(wlst, 1),
  "Early Withdrawal of Life-Sustaining Therapy" = pluck(early_wlst, 1),
  "DNR Order" = pluck(dnr, 1)
)

# combine % of posterior within the ROPE
rope <- list(
  "Neurosurgical Intervention" = pluck(neurosurgery, 4),
  "External Ventricular Drain" = pluck(evd, 4),
  "Tracheostomy" = pluck(trach, 4),
  "Days of Mechanical Ventilation" = pluck(vent, 4),
  "Withdrawal of Life-Sustaining Therapy" = pluck(wlst, 4),
  "Early Withdrawal of Life-Sustaining Therapy" = pluck(early_wlst, 4),
  "DNR Order" = pluck(dnr, 4)
)

table1 <- bind_rows(odds_ratios, credible_ints)
table2 <- bind_rows(prob_difference, rope) |> mutate(across(1:7, as.character))

pre_tab <- as_tibble(t(bind_rows(table1, table2)))

table_2 <- with_dir(here(), tar_read(table_2_aggressive))
tibble_2 <- as_tibble(table_2) |> select(-1)

column_names <- c(
  "Neurosurgical Intervention",
  "External Ventricular Drain",
  "Tracheostomy",
  "Days of Mechanical Ventilation",
  "Withdrawal of Life-Sustaining Therapy",
  "Early Withdrawal of Life-Sustaining Therapy",
  "DNR Order"
)

combined <- bind_cols(column_names, tibble_2, pre_tab) |>
  rename(
    "Right Hemisphere" = "**Right**, N = 1,757",
    "Left Hemisphere" = "**Left**, N = 1,720",
    "Outcome" = ...1,
    "aOR" = V1,
    "95% Credible Interval" = V2,
    "Probability of Difference (aOR >1)" = V3,
    "% ROPE" = V4
  )

flextable(combined) |>
  font(part = "all", fontname = "Figtree") |>
  fontsize(size = 10) |>
  theme_zebra() |>
  line_spacing(space = 1.25, part = "all") |>
  padding(padding = 4, part = "all") |>
  bold(part = "header") |>
  bold(i = 1) |>
  padding(padding = 5, part = "all") |>
  width(width = 50, j = 1) |>
  width(width = 2, j = 2:3) |>
  width(width = 4, j = 4:6)

```

### Left hemispheric ICH and other measures of aggressive care

### Subgroup analyses

### Sensitivity analyses

## Discussion

Hello

## Acknowledgments {.appendix}

## References {.appendix}