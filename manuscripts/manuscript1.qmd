---
title: Patients with Left Hemispheric Intracerebral Hemorrhage are Less Likely to Receive Neurosurgical Intervention
author: "Nikhil Patel, MD"
subtitle: A Post Hoc Bayesian of ATACH-2 and ERICH data
authors:
  - name: Nikhil Patel
    orcid: 0000-0002-3193-8590
    affiliation: Department of Internal Medicine, Wake Forest University School of Medicine
    roles: data analysis, writing
    corresponding: true
  - name: Matt Jaffa
    affiliation: Department of Neurology, University of Connecticut School of Medicine
  - name: Rahul Karamchandani
    affiliation: Department of Neurology, Wake Forest University School of Medicine
  - name: Andrew Asimos
    affiliation: Department of Emergency Medicine, Wake Forest University School of Medicine
  - name: Jonathan Parish
    affiliation: Carolina Neurosurgery & Spine Associates
  - name: Nicholas Allen Morris
    affiliation: Department of Neurology, University of Maryland School of Medicine
date: last-modified
abstract: |
  
table-of-contents: true
toc-title: Contents
---

```{r setup}
#| echo: false
#| output: false

library(targets)
library(tidyverse)
library(withr)
library(here)
library(formattable)
library(gt)
library(gtsummary)
library(modelsummary)
library(marginaleffects)
library(tidybayes)
library(bayesplot)
library(ggdist)
library(patchwork)
library(tinytable)
library(flextable)

# plot stuff
theme_ich <- function(base_family = "Figtree",
                      base_size = 14) {
  theme_minimal(base_size = base_size) +
    theme(
      text = element_text(lineheight = 2),
      plot.title = element_text(size = rel(1.3), margin = margin(12, 0, 8, 0)),
      plot.subtitle = element_text(size = rel(1.1), margin = margin(4, 0, 0, 0)),
      axis.text.y = element_text(size = rel(0.8)),
      axis.title.y = element_text(size = 12, margin = margin(0, 4, 0, 0)),
      axis.text.x = element_text(size = rel(2)),
      axis.title.x = element_blank(),
      legend.position = "bottom",
      legend.justification = 1,
      panel.grid = element_line(colour = "#F3F4F5"),
      plot.caption = element_text(size = rel(0.8), margin = margin(8, 0, 0, 0)),
      plot.margin = margin(0.25, 0.25, 0.25, 0.25, "cm")
    )
}

# load data and models
with_dir(here(), tar_load(ich_aggressive))

sample_size <- count(ich_aggressive)

left_hemisphere_count <- ich_aggressive |>
  filter(ich_laterality == "Left") |>
  count()

models <- list(
  "Neurosurgical Intervention" = with_dir(here(), tar_read(m_posterior_neurosurgery_canonical)),
  "External Ventricular Drain" = with_dir(here(), tar_read(m_posterior_evd_canonical)),
  "Tracheostomy" = with_dir(here(), tar_read(m_posterior_trach_canonical)),
  "Days of Mechanical Ventilation" = with_dir(here(), tar_read(m_posterior_vent_canonical)),
  "Withdrawal of Life-Sustaining Therapy" = with_dir(here(), tar_read(m_posterior_comfort_canonical)),
  "Early Withdrawal of Life-Sustaining Therapy" = with_dir(here(), tar_read(m_posterior_early_comfort_canonical)),
  "DNR Order" = with_dir(here(), tar_read(m_posterior_dnr_canonical))
)

```

## Introduction
Intracerebral hemorrhage (ICH) remains a challenging disease, marked by its sudden onset, morbidity, and mortality. While ischemic stroke has garnered considerable attention and therapeutic advancements, the acute management of ICH remains limited to blood pressure control, coagulopathy reversal, and more recently surgical evacuation of hemorrhage [@pradillaTrialEarlyMinimally2024]. Overwhelmingly these efforts have focused on reducing mortality and preventing additional morbidity due to secondary injury.

Clinical presentations for patients with stroke are varied based on the hemisphere affected, where hemispheric dominance dictates cognitive processing, attention, language, and emotional responses. Consequently, when confronted with the occurrence of ICH, the specific hemisphere affected can profoundly influence not only the clinical presentation but also therapeutic strategies and prognostic outcomes.

Previous research involving patients with ischemic stroke provide evidence that those with right hemispheric injury present later to the hospital and may not be treated as frequently with thrombolytic therapy. [@dileggeImpactLesionSide2005; @foerchDifferenceRecognitionRight2005; @portegiesLeftsidedStrokesAre2015;  @liStrokeLateralizationLarge2021] It has also been noted that there is a hesitation among some practitioners to offer decompressive craniectomy in patients with left dominant-hemispheric ischemic infarcts3 despite literature demonstrating that long-term functional outcomes and health-related quality of life (HRQoL) are equivalent if not better for patients with left hemispheric injuries. [@deb-chatterjiSideMattersDifferences2022; @leggeNeglectingDifference2006; @beuscherFunctionalLongTermOutcome2017; @satoHigherMortalityPatients2015]

It is uncertain how the results of prior work in the ischemic stroke literature translate to patients experiencing acute ICH. We aimed to evaluate the effect of hemispheric lateralization of ICH on likelihood of receiving aggressive surgical intervention. 

## Methods

### Study Design and Participants
We conducted a post-hoc analysis using data from 2 prospective studies: the Antihypertensive Treatment of Acute Cerebral Hemorrhage II (ATACH-2) trial [@qureshiIntensiveBloodPressureLowering2016] and the Ethnic/Racial Variations of Intracerebral Hemorrhage (ERICH) [@wooEthnicRacialVariations2013] study. ATACH-2 was a large, multicenter, international, open-label, blinded-endpoint randomized controlled trial enrolling 1000 patients with ICH and randomizing them to either intesive blood pressure control (110-139 mm Hg) or standard blood pressure control (140-179 mm Hg). ERICH was a large, multicenter, prospective observational study enrolling patients in the United States admitted with ICH. Study protocols and results of both studies have been previously published.

We included all patients enrolled in these two studies with supratentorial location of ICH. We excluded patients with cerebellar or brainstem ICH as well as any patient with primary intraventricular hemorrhage (IVH).

The study was approved by the institutional review board of the Wake Forest School of Medicine.

### Exposures and Outcomes
Our exposure was hemispheric laterality (left versus right). Our primary outcome was neurosurgical intervention as a binary variable defined as receiving a hematoma evacuation, decompressive craniectomy, or other craniotomy.

To explore differences in other aspects of aggressive care, we defined several secondary outcomes: receipt of external ventricular drain (EVD), receipt of tracheostomy, days of mechanical ventilation, receipt of do-not-resuscitate (DNR) order at any point in the hospitalization, withdrawal of life-sustaining therapy (WLST) at any point in the hospitalization, and early WLST (defined as < 72 from symptom onset).

### Statistical Analysis
To estimate the effect of hemispheric laterality on the outcomes of interest, we fitted hierarchal Bayesian regression models adjusted for the specified covariates below and study as a random intercept. This report follows suggestions from the Bayesian Analysis Reporting Guidelines [@kruschkeBayesianAnalysisReporting2021]. For binary endpoints, hierarchal Bayesian logistic regression models were used. For ordinal endpoints, hierarchal Bayesian ordinal logisitic regression models were used. All analyses were performed in R version 4.4.1 (R Foundation for Statistical Computing, Vienna, Austria) using the 'brms' and 'tidybayes' packages.

#### Covariate Selection
We constructed directed acyclic graphs (DAGs) to model our causal assumptions and to appropriately select variables to minimize confounding and selection bias. Based on our specifications, we included the following covariates in our models: age, admission Glasgow coma score (GCS), ICH location (categorized as lobar, thalamic, or basal ganglia), baseline ICH volume (measured in millilters), and presence of intraventricular hemorrhage (IVH). The DAGs used in the analyses are available in the supplementary material.

#### Prior Distribution Specification
Two sets of priors were applied for all models, both assuming no association of hemispheric laterality on the outcomes of interest: 1) default, weakly informative priors as defined by the 'brms' software package; 2) priors informed from review of previous literature. A description of the reasons for these priors is available in the supplementary material.

#### Computation and Description of the Posterior Distribution
We report the following metrics for the effect of hemispheric laterality on the primary and secondary outcomes: 1) median odds ratio (OR) of the posterior distribution with 95% credible interval; 2) probability of any difference (P[OR] > 1); 3) probability of a large difference (P[OR] > 1.2) as defined by the study authors; 4) percent of the posterior distribution outside of the region of practical equivalence as defined by the study authors (ROPE; 0.95 > P[OR] > 1.05). A description of the reasons for these thresholds is available in the supplementary material.

#### Missing value policies



### Data Availability Statement
The ATACH-2 (PI: Adnan I. Qureshi, MD, NCT01176565) and ERICH (PI: Daniel Woo, MD, MS, NCT01202864) data and analyses presented in this manuscript are based on the research files downloaded from the Archived Clinical Research web site of the National Institute of Neurologic Disease and Stroke (NINDS). The datasets can be obtained after approval of a written proposal as outlined on the NINDS website. As outlined in the NINDS Data Request Agreement, the analysis code is publicly available at [https://github.com/nikhilpatelmd/ich-laterality](https://github.com/nikhilpatelmd/ich-laterality).

## Results

### Baseline Characteristics

A total of `r sample_size` patients were included in the analysis, of which `r left_hemisphere_count` (`r percent(left_hemisphere_count/sample_size, digits = 1)`) had left hemispheric ICH. They had higher NIHSS scores, lower GCS scores, and lower rates of hypertension as compared to those with right hemispheric ICH (@tbl-1).

```{r table1}
#| label: tbl-1
#| tbl-cap: "Baseline Characteristics"
#| echo: false

with_dir(here(), tar_read(table_1_aggressive))

```

### Left hemispheric ICH and neurosurgical intervention

```{r neurosurgery}
#| label: tbl-2
#| tbl-cap: "Association between hemispheric lateralization and care"
#| echo: false

# gather odds ratios and 95% credible intervals for each outcome
summary <- modelsummary(models,
  exponentiate = TRUE,
  fmt = 2,
  estimate = c("aOR" = "estimate"),
  statistic = c("95% Credible Interval" = "{conf.low} - {conf.high}"),
  coef_omit = "^(?!b_ich_lat)",
  coef_rename = c("b_ich_lateralityRight" = "Right Hemisphere ICH"),
  gof_map = c("none"),
  shape = model ~ term + statistic,
)

aOR_CIs_combined <- as_tibble(summary@table_dataframe) |>
  rename("Outcome" = " ")

aOR_CIs_combined[1] <- c(
  "Neurosurgical Intervention",
  "External Ventricular Drain",
  "Tracheostomy",
  "Days of Mechanical Ventilation",
  "Withdrawal of Life-Sustaining Therapy",
  "Early Withdrawal of Life-Sustaining Therapy",
  "DNR Order"
)

# gather posterior probabilities of various magnitudes of difference for each outcome

neurosurgery <- models$"Neurosurgical Intervention" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

evd <- models$"External Ventricular Drain" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

trach <- models$"Tracheostomy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

vent <- models$"Days of Mechanical Ventilation" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

dnr <- models$"DNR Order" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

wlst <- models$"Withdrawal of Life-Sustaining Therapy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )

early_wlst <- models$"Early Withdrawal of Life-Sustaining Therapy" |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_or = exp(b_ich_lateralityRight)) |>
  summarize(
    or_1 = sum(ich_right_or > 1) / n(),
    or_1.1 = sum(ich_right_or > 1.1) / n(),
    or_1.2 = sum(ich_right_or > 1.2) / n(),
    rope = sum(ich_right_or < 1.05 & ich_right_or > 0.95) / n()
  )


# combine probability of OR > 1 (prob of difference)
prob_difference <- tibble(
  "Neurosurgical Intervention" = pluck(neurosurgery, 1),
  "External Ventricular Drain" = pluck(evd, 1),
  "Tracheostomy" = pluck(trach, 1),
  "Days of Mechanical Ventilation" = pluck(vent, 1),
  "Withdrawal of Life-Sustaining Therapy" = pluck(wlst, 1),
  "Early Withdrawal of Life-Sustaining Therapy" = pluck(early_wlst, 1),
  "DNR Order" = pluck(dnr, 1)
) |>
  pivot_longer(
    cols = everything(),
    names_to = "Outcome",
    values_to = "Probabilty of any difference (aOR > 1)"
  )

# combine % of posterior within the ROPE
rope <- tibble(
  "Neurosurgical Intervention" = pluck(neurosurgery, 4),
  "External Ventricular Drain" = pluck(evd, 4),
  "Tracheostomy" = pluck(trach, 4),
  "Days of Mechanical Ventilation" = pluck(vent, 4),
  "Withdrawal of Life-Sustaining Therapy" = pluck(wlst, 4),
  "Early Withdrawal of Life-Sustaining Therapy" = pluck(early_wlst, 4),
  "DNR Order" = pluck(dnr, 4)
) |>
  pivot_longer(
    cols = everything(),
    names_to = "Outcome",
    values_to = "% within ROPE"
  )

table_almost_2 <- left_join(aOR_CIs_combined, prob_difference, by = "Outcome") |>
  left_join(rope, by = "Outcome")

table_2 <- with_dir(here(), tar_read(table_2_aggressive))
tibble_2 <- as_tibble(table_2) |> select(-1)

column_names <- c(
  "Neurosurgical Intervention",
  "External Ventricular Drain",
  "Tracheostomy",
  "Days of Mechanical Ventilation",
  "Withdrawal of Life-Sustaining Therapy",
  "Early Withdrawal of Life-Sustaining Therapy",
  "DNR Order"
)

tibble_2 <- bind_cols(column_names, tibble_2) |>
  rename(
    "Right Hemisphere" = "**Right**, N = 1,757",
    "Left Hemisphere" = "**Left**, N = 1,720",
    "Outcome" = ...1
  ) |>
  full_join(table_almost_2, by = "Outcome")

tt(tibble_2, digits = 4)



```

## Discussion

## Conclusions