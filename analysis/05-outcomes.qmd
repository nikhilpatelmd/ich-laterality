---
title: "Outcomes"
code-fold: true
---

{{< include 00-setup.qmd >}}


We will first run a "dummy" regression so I can interpret the results even before all data is cleaned. 

```{r brms priors, warning=FALSE, message=FALSE}

priors <- c(
  prior(normal(0, 10), class = "b")
)

mod_mrs_90 <- brm(
  mrs_90 ~ ich_laterality + age + ich_location + ich_volume_baseline + gcs_baseline + neurosurgery_evac,
  data = data,
  family = cumulative(link = "logit"),
  prior = priors,
  chains = 4,
  iter = 5000 * 2,
  seed = BAYES_SEED,
  refresh = 0
)

pp_check(mod_mrs_90, type = "bars", ndraws = 100)
pp_check(mod_mrs_90, type = "ecdf_overlay", ndraws = 100)

model_parameters(mod_mrs_90,
  centrality = "mean", dispersion = TRUE,
  test = FALSE, verbose = FALSE, ci_method = "hdi", priors = TRUE,
  exponentiate = TRUE
) |>
  print(digits = 3, zap_small = TRUE)

get_variables(mod_mrs_90)

draws <- mod_mrs_90 |>
  spread_draws(b_ich_lateralityRight) |>
  mutate(ich_right_OR = exp(b_ich_lateralityRight))

draws |>
  ggplot(aes(x = ich_right_OR)) +
  stat_halfeye(aes(fill_ramp = stat(x > 1), fill = "green"))

# Find the proportion of posterior draws that are bigger than OR of 1
draws %>%
  summarize(prop_greater_0 = sum(ich_right_OR > 1) / n())

# Find the proportion of posterior draws that are bigger than OR of 1.2
draws %>%
  summarize(prop_greater_0 = sum(ich_right_OR > 1.2) / n())


```

## Outcomes


```{r euroqol, warning=FALSE, message=FALSE}
#| fig-width: 10

data <- read_csv(here("data", "all.csv")) |>
  filter(ich_location == c("Lobar", "Basal Ganglia", "Thalamus")) |>
  filter(!is.na(ich_laterality))

data |>
  ggplot(aes(euro_vas_90, fill = ich_laterality)) +
  geom_density(color = NA, alpha = .8)

```

