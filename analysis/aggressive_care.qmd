---
title: "Aggressive Care and Hemispheric Laterality"
---
{{< include 00-setup.qmd >}}

I am interested in seeing if hemispheric laterality affects the aggressiveness of care that a patient receives. This mostly includes neurosurgery, but also other processes such as days of mechanical ventilation, EVD placement, rates of tracheostomy/PEG, and if patients were transitioned to comfort care.

I will be using observational data from the ERICH study, as well as the randomized trial data from ATACH-2 to answer these questions. 

## The Question

**Do patients with left hemispheric ICH receive neurosurgical evacuations less frequently as compared to patients with right hemispheric ICH?**

We want to determine if there's a substantial difference in the proportion of patients who receive neurosurgical intervention in the right or left hemisphere.


```{r color setup}

# Left/Right hemisphere question colors
clrs_saguaro <- NatParksPalettes::natparks.pals("Saguaro")
clr_left <- clrs_saguaro[1]
clr_right <- clrs_saguaro[6]
clr_diff <- clrs_saguaro[4]

```


```{r neurosurgery, warning=FALSE, message=FALSE}

table_two_vars <- c("neurosurgery_evac", "evd", "days_mechanical_ventilation", "tracheostomy", "ich_laterality", "comfort_care_binary")

table2 <- data_erich_atach |>
  select(table_two_vars) |>
  tbl_summary(
    by = ich_laterality,
    missing = "no",
    label = list(
      neurosurgery_evac ~ "Neurosurgical Intervention",
      evd ~ "Ventriculostomy",
      days_mechanical_ventilation ~ "Intubation Days",
      tracheostomy ~ "Tracheostomy",
      comfort_care_binary ~ "Comfort Care"
    )
  ) |>
  add_p() |>
  add_overall() |>
  bold_labels()

table2

```

## Neurosurgical Intervention - Multivariate Regression

```{r neurosurgical intervention, warning=FALSE, message=FALSE}
#| fig-width: 10

neurosurgery_glm <- glm(
  neurosurgery_evac ~ ich_laterality + age + ich_location + gcs_baseline + ich_volume_baseline + ivh + time_symptoms_to_ed,
  data = data_erich_atach,
  family = binomial
)

neurosurgery_glm |>
  tbl_regression(
    exponentiate = TRUE,
    include = ich_laterality
  )

vent_glm <- glm(
  days_mechanical_ventilation ~ ich_laterality + age + ich_location + gcs_baseline + ich_volume_baseline + ivh + time_symptoms_to_ed,
  data = data_erich_atach,
  family = poisson
)

vent_glm |>
  tbl_regression(
    exponentiate = TRUE,
    include = ich_laterality
  )

comfort_glm <- glm(
  comfort_care_binary ~ ich_laterality + age + ich_location + gcs_baseline + ich_volume_baseline + ivh + time_symptoms_to_ed,
  data = data_erich_atach,
  family = binomial
)

comfort_glm |>
  tbl_regression(
    exponentiate = TRUE,
    include = ich_laterality
  )


```
