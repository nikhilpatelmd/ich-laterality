---
title: "Aggressive Care and Hemispheric Laterality"
---
{{< include 00-setup.qmd >}}

I am interested in seeing if hemispheric laterality affects the aggressiveness of care that a patient receives. This mostly includes neurosurgery, but also other processes such as days of mechanical ventilation, EVD placement, rates of tracheostomy/PEG, and if patients were transitioned to comfort care.

I will be using observational data from the ERICH study, as well as the randomized trial data from ATACH-2 to answer these questions. 

## Exploratory Data Analysis

Loading the data from ATACH-2 and ERICH, and filtering out the variables needed for the analysis.

```{r loading data}

# load data
data <- read_rds(here("data", "all.rds"), refhook = NULL)

# filter out only ERICH and ATACH2 and keep relevant variables
cleaned_data <- data |>
  mutate(id = 1:n()) |>
  filter(study == "ERICH" | study == "ATACH-2") |>
  select(id, study, ich_laterality, age, sex, race, ethnicity, sbp_baseline, gcs_baseline, ich_volume_baseline, ivh, ich_location, neurosurgery_evac, evd, tracheostomy, peg, comfort_care_binary, comfort_care_day) |>
  drop_na(ich_laterality, neurosurgery_evac)


```

Now we can summarize the preliminary data.


```{r exploratory data analysis}

counts <- cleaned_data |>
  tabyl(ich_laterality, neurosurgery_evac, ich_location) |>
  adorn_percentages("row") |>
  adorn_pct_formatting(rounding = "half up", digits = 1)

counts

counts_tidy <- cleaned_data |>
  group_by(ich_laterality, neurosurgery_evac) |>
  summarize(n = n()) |>
  mutate(
    total = sum(n),
    prop = n / sum(n)
  ) |>
  ungroup()


counts_tidy

ggplot(cleaned_data) +
  geom_mosaic(
    aes(
      x = product(neurosurgery_evac, ich_laterality),
      fill = ich_laterality, alpha = neurosurgery_evac
    ),
    divider = mosaic("v")
  )

```

## The Question

**Do patients with left hemispheric ICH receive neurosurgical evacuations less frequently as compared to patients with right hemispheric ICH?**

We want to determine if there's a substantial difference in the proportion of patients who receive neurosurgical intervention in the right or left hemisphere.


```{r color setup}

# Left/Right hemisphere question colors
clrs_saguaro <- NatParksPalettes::natparks.pals("Saguaro")
clr_left <- clrs_saguaro[1]
clr_right <- clrs_saguaro[6]
clr_diff <- clrs_saguaro[4]

```

